<!DOCTYPE html> 
<html lang="es"> 
<head> 
    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>Acceso de Usuarios</title> 
    <link rel="stylesheet" href="../public/assets/css/login.css"> 
</head> 
<body> 
    <div class="login-container"> 
        <h2>Accede a nuestros cursos </h2> 
        <form id="login-form"> 
            <div class="input-group"> 
                <label for="nombreUsuario">Usuario (Correo Electrónico)</label> 
                <input type="text" id="nombreUsuario" name="nombreUsuario" required> 
            </div> 
            <div class="input-group"> 
                <label for="contrasena">Contraseña</label> 
                <input type="password" id="contrasena" name="contrasena" required> 
            </div> 
            <div class="button-group"> 
                <button id="btnIniciarSesion" type="submit">Iniciar Sesión</button> 
                <a href="index.php?view=registro"><button id="btnRegistrar" type="button">Registrar</button></a> 
            </div> 
        </form> 
    </div> 

    <script>
        document.getElementById('login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const form = e.target;
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());

            fetch('../public/api.php/auth/login',  { // Endpoint de la API para Login
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data),
            })
            .then(response => response.json())
            .then(result => {
                if (result.success) {
                    alert('¡Inicio de sesión exitoso!');
                    // Redirigir a la Landing Page (la vista 'landing')
                    window.location.href = 'index.php?view=landing';
                } else {
                    // Mostrar el mensaje de error que viene del controlador
                    alert(result.message);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Ocurrió un error en la comunicación con el servidor.');
            });
        });
    </script>
</body> 
</html>